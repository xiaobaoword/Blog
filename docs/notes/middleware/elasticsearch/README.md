---
title: Elasticsearch
createTime: 2024/12/18 10:40:11
permalink: /middleware/elasticsearch/
---

## æ¦‚è¿°

Elasticsearch æ˜¯ **JAVA** è¯­è¨€å¼€å‘åŸºäº **Lucene** ä¸€ä¸ª **åˆ†å¸ƒå¼** çš„ã€åŸºäº Lucene çš„ **æœç´¢å¼•æ“** å’Œ **åˆ†æå¼•æ“**ã€‚

å®ƒèƒ½å¤Ÿå¿«é€Ÿåœ°å­˜å‚¨ã€æœç´¢å’Œåˆ†æå¤§é‡æ•°æ®ã€‚

Elasticsearch ç»å¸¸ç”¨äºæ—¥å¿—åˆ†æã€å®æ—¶åº”ç”¨ç›‘æ§ã€å…¨æ–‡æ£€ç´¢ç­‰åœºæ™¯ã€‚

å®ƒçš„ç‰¹ç‚¹åŒ…æ‹¬é«˜æ‰©å±•æ€§ã€è¿‘å®æ—¶æœç´¢èƒ½åŠ›ä»¥åŠå¯¹ç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ®çš„æ”¯æŒã€‚

## åˆ†å¸ƒå¼

## æœç´¢å¼•æ“

### å€’æ’ç´¢å¼•

å€’æ’ç´¢å¼•ä½œä¸ºESçš„æ ¸å¿ƒï¼Œåº•å±‚åŸºäºLuceneè¿›è¡Œå®ç°ã€‚

å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰ä¹Ÿå«åå‘ç´¢å¼•ï¼Œæœ‰åå‘ç´¢å¼•å¿…æœ‰æ­£å‘ç´¢å¼•ã€‚

é€šä¿—åœ°æ¥è®²ï¼Œæ­£å‘ç´¢å¼•æ˜¯é€šè¿‡æ–‡æ¡£IDæ‰¾å•è¯ã€‚åå‘ç´¢å¼•åˆ™æ˜¯é€šè¿‡å•è¯æ‰¾æ–‡æ¡£IDã€‚

## åˆ†æå¼•æ“

### æ–‡æœ¬åˆ†æï¼ˆAnalysisï¼‰

æ–‡æœ¬åˆ†ææ˜¯å°†å…¨æ–‡æœ¬æ‹†åˆ†ä¸ºä¸€ç³»åˆ—æœ€å°å•å…ƒï¼ˆtokenï¼‰çš„è¿‡ç¨‹ï¼Œç§°ä¸ºåˆ†è¯ã€‚

å®ƒæ˜¯è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰é¢†åŸŸä¸­çš„é‡è¦è¿‡ç¨‹ã€‚

è¿™ä¸ªè¿‡ç¨‹æ˜¯é€šè¿‡åˆ†è¯å™¨ï¼ˆAnalyzerï¼‰æ¥å®ç°çš„ï¼Œesæœ‰å†…ç½®çš„åˆ†è¯å™¨ã€ä¹Ÿæœ‰è‡ªå®šä¹‰åˆ†è¯å™¨ã€‚

### åˆ†è¯å™¨ï¼ˆAnalyzerï¼‰

åˆ†è¯å™¨ï¼ˆAnalyzerï¼‰ç”±ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†ç»„æˆï¼š

- å­—ç¬¦è¿‡æ»¤å™¨ï¼ˆCharacter Filtersï¼‰

- åˆ†è¯å™¨ï¼ˆTokenizerï¼‰

- token è¿‡æ»¤å™¨ï¼ˆToken Filtersï¼‰

å®ƒä»¬æŒ‰ç…§**é¡ºåº**ä¾æ¬¡å¤„ç†æ–‡æœ¬ï¼Œå®Œæˆä»åŸå§‹æ–‡æœ¬åˆ°å¯ç´¢å¼•è¯æ¡ï¼ˆTermsï¼‰çš„è½¬æ¢ã€‚

#### 1. å­—ç¬¦è¿‡æ»¤å™¨ï¼ˆCharacter Filtersï¼‰

æ–‡æœ¬åˆ†æçš„ç¬¬ä¸€æ­¥ï¼Œå¯¹åŸå§‹æ–‡æœ¬è¿›è¡Œé¢„å¤„ç†ã€‚

å®ƒç”¨äºç­›é€‰ã€è½¬æ¢æˆ–ç§»é™¤ç‰¹å®šå­—ç¬¦ï¼Œä¾‹å¦‚ï¼šç§»é™¤HTMLæ ‡ç­¾ã€è½¬æ¢ä¸ºå°å†™ã€æ›¿æ¢æŸäº›å­—ç¬¦ç­‰ã€‚

#### 2. åˆ†è¯å™¨ï¼ˆTokenizerï¼‰

æ–‡æœ¬åˆ†æçš„ç¬¬äºŒæ­¥ï¼Œå­—ç¬¦ä¸²è¢«åˆ†è¯å™¨æŒ‰ç…§è§„åˆ™åˆ†ä¸ºå•ä¸ªçš„å•è¯ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å°†è¿ç»­çš„æ–‡æœ¬åˆ†å‰²æˆä¸€ä¸ªä¸ªç‹¬ç«‹çš„å•å…ƒï¼ˆå¦‚å•è¯æˆ–å­è¯ï¼‰ï¼Œè¿™äº›å•å…ƒæ˜¯æ›´å°çš„è¯æ¡ï¼Œè¢«ç§°ä¸º tokensã€‚

è¿™å¯¹äºåç»­çš„å„ç§æ–‡æœ¬å¤„ç†ä»»åŠ¡ï¼ˆå¦‚æœºå™¨ç¿»è¯‘ã€æƒ…æ„Ÿåˆ†æç­‰ï¼‰æ˜¯éå¸¸å…³é”®çš„æ­¥éª¤ã€‚ä¸åŒçš„è¯­è¨€å¯èƒ½éœ€è¦ä¸åŒç±»å‹çš„åˆ†è¯å™¨ï¼Œå› ä¸ºè¯­è¨€ç»“æ„å’Œè¯­æ³•è§„åˆ™å„ä¸ç›¸åŒã€‚ä¾‹å¦‚ï¼Œåœ¨è‹±æ–‡ä¸­ï¼Œåˆ†è¯å™¨å¯ä»¥æ ¹æ®ç©ºæ ¼æ¥åŒºåˆ†å•è¯ï¼›è€Œåœ¨ä¸­æ–‡ä¸­ï¼Œåˆ™éœ€è¦æ›´å¤æ‚çš„ç®—æ³•æ¥è¯†åˆ«è¯è¯­çš„è¾¹ç•Œã€‚

**åŠŸèƒ½**

- åˆ†å‰²æ–‡æœ¬ï¼šæ ¹æ®ç©ºæ ¼ã€æ ‡ç‚¹ç¬¦å·æˆ–å…¶ä»–è§„åˆ™å°†æ–‡æœ¬æ‹†åˆ†ä¸º tokensã€‚

- ç”Ÿæˆè¯æ±‡å•å…ƒï¼šç¡®ä¿æ¯ä¸ª token æ˜¯æœ‰æ„ä¹‰çš„è¯è¯­æˆ–ç¬¦å·ã€‚

**Elasticsearch çš„å†…ç½®åˆ†è¯å™¨**

- Standard Analyzer - é»˜è®¤åˆ†è¯å™¨ï¼ŒæŒ‰è¯åˆ‡åˆ†ï¼Œå°å†™å¤„ç†

- Simple Analyzer - æŒ‰ç…§éå­—æ¯åˆ‡åˆ†(ç¬¦å·è¢«è¿‡æ»¤)ï¼Œå°å†™å¤„ç†

- Stop Analyzer-å°å†™å¤„ç†ï¼Œåœç”¨è¯è¿‡æ»¤(theï¼Œaï¼Œis)

- Whitespace Analyzer - æŒ‰ç…§ç©ºæ ¼åˆ‡åˆ†ï¼Œä¸è½¬å°å†™

- Keyword Analyzer - ä¸åˆ†è¯ï¼Œç›´æ¥å°†è¾“å…¥å½“ä½œè¾“å‡º

- Patter Analyzer - æ­£åˆ™è¡¨è¾¾å¼ï¼Œé»˜è®¤\W+(éå­—ç¬¦åˆ†éš”)

- Language - æä¾›äº†30å¤šç§å¸¸è§è¯­è¨€çš„åˆ†è¯å™¨

- Customer Analyzer è‡ªå®šä¹‰åˆ†è¯å™¨

#### 3. token è¿‡æ»¤å™¨ï¼ˆToken Filtersï¼‰

æ–‡æœ¬åˆ†æçš„ç¬¬ä¸‰æ­¥ï¼Œå®ƒä»¬å¯¹å·²ç»åˆ†è¯åçš„ token è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†æˆ–è½¬æ¢ã€‚ä¸å­—ç¬¦è¿‡æ»¤å™¨ä¸åŒï¼Œtoken è¿‡æ»¤å™¨ä¸ä¼šæ”¹å˜åŸå§‹æ–‡æœ¬ï¼Œè€Œæ˜¯ç›´æ¥æ“ä½œå·²ç»ç”Ÿæˆçš„ tokenã€‚

::: warning

è¿™é‡Œçš„tokenç»å¸¸æ··æ·†ï¼Œæœ‰è¢«ç§°ä¸º termï¼Œtokenï¼Œè¯å…ƒï¼Œè¯é¡¹ï¼Œè¯æ¡è¯¸å¦‚æ­¤ç±»çš„åè¯ï¼Œæ‰€ä»¥ç›´æ¥ç§°ä¸º **token**

token æ˜¯ä¸€ä¸ªåœ¨åˆ†è¯é˜¶æ®µä¸­äº§ç”Ÿçš„æœ€å°å•ä½ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª Tokne å¯¹è±¡

term æ˜¯ä¸€ä¸ªåœ¨æ„å»ºå€’æ’ç´¢å¼•é˜¶æ®µäº§ç”Ÿçš„æœ€å°å•ä½ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª Term å¯¹è±¡ã€‚

:::

**åŠŸèƒ½**

- å¤§å°å†™è½¬æ¢ï¼šå°†æ‰€æœ‰ tokens ç»Ÿä¸€ä¸ºå°å†™æˆ–å¤§å†™å½¢å¼ã€‚

- å»é™¤åœç”¨è¯ï¼šç§»é™¤å¸¸è§çš„æ— æ„ä¹‰è¯æ±‡ï¼Œå¦‚â€œtheâ€ã€â€œisâ€ã€â€œaâ€ç­‰ã€‚

- è¯å¹²æå–ï¼šå°†è¯è¯­è¿˜åŸä¸ºå…¶è¯æ ¹å½¢å¼ï¼ˆä¾‹å¦‚ï¼Œâ€œrunningâ€ -> â€œrunâ€ï¼‰ã€‚

- åŒä¹‰è¯æ‰©å±•ï¼šæ ¹æ®åŒä¹‰è¯è¡¨å°†æŸä¸ª token æ›¿æ¢ä¸ºå¤šä¸ªåŒä¹‰è¯ã€‚

- è¯å½¢è¿˜åŸï¼šå°†è¯è¯­è¿˜åŸä¸ºæ ‡å‡†å½¢å¼ï¼ˆä¾‹å¦‚ï¼Œâ€œbetterâ€ -> â€œgoodâ€ï¼‰ã€‚

- n-gram ç”Ÿæˆï¼šä¸ºæ¯ä¸ª token ç”Ÿæˆè¿ç»­çš„ n-gram æˆ–å‰ç¼€ n-gramã€‚

## é—®é¢˜

### ESå†™å…¥æ•°æ®çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ



### ESæŸ¥è¯¢æ•°æ®çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ


## å­¦ä¹ èµ„æ–™

[æå®¢æ—¶é—´-Elasticsearchæ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜ é˜®ä¸€é¸£](https://time.geekbang.org/course/intro/100030501) [ğŸ”¨](https://www.youtube.com/playlist?list=PLn5XLkWHBxyuTUqxpuwdPEwO3ZoxwhkyS)

[Elastic ä¸­å›½ç¤¾åŒºå®˜æ–¹åšå®¢](https://elasticstack.blog.csdn.net/?type=blog)

[ElasticSearchæ ¸å¿ƒçŸ¥è¯†è®²è§£](https://developer.aliyun.com/article/941168)

### Logstash

å…¥é—¨è·Ÿç»ƒ

[Logstashï¼šLogstash å…¥é—¨æ•™ç¨‹ ï¼ˆä¸€ï¼‰](https://blog.csdn.net/UbuntuTouch/article/details/105973985)

[Logstashï¼šLogstash å…¥é—¨æ•™ç¨‹ ï¼ˆäºŒï¼‰](https://elasticstack.blog.csdn.net/article/details/105979677)

[Logstashï¼šæŠŠ Apache æ—¥å¿—å¯¼å…¥åˆ° Elasticsearch](https://blog.csdn.net/UbuntuTouch/article/details/100727051)

## to do list

Elasticsearch å·¥ç¨‹å¸ˆè®¤è¯è€ƒè¯•
